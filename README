yii-twitter-oauth

Twitter Oauth Library

This is a mod





**Installation**

* Extract the release files under 'protected/extensions'

* Configure settings in 'Main.php'


**Site Configuration**

		

For Single Sign On (SSO)

		'components'=>array(	
			'twitter' => array(
				'class' => 'ext.yiitwitteroauth.YiiTwitter',
				'consumer_key' => 'YOUR_TWITTER_CONSUMER_KEY',
				'consumer_secret' => 'YOUR_TWITTER_CONSUMER_SECRET',
				'callback' => 'YOUR_TWITTER_CALLBACK_URL',
			),
		...


	
	
**Usage**


Generating an Auth URL

			$twitter = Yii::app()->twitter->getTwitter();	
			$request_token = $twitter->getRequestToken();
		
			$_SESSION['oauth_token'] = $token = $request_token['oauth_token'];
			$_SESSION['oauth_token_secret'] = $request_token['oauth_token_secret'];

			if($twitter->http_code == 200){
				$url = $twitter->getAuthorizeURL($token);
				header('location: '.$url);
			}
			
			
Twitter Callback


			/* If the oauth_token is old redirect to the connect page. */
			if (isset($_REQUEST['oauth_token']) && $_SESSION['oauth_token'] !== $_REQUEST['oauth_token']) {
				$_SESSION['oauth_status'] = 'oldtoken';
				header('Location: ./clearsessions.php');
			}

			/* Create TwitteroAuth object with app key/secret and token key/secret from default phase */
			$twitter = Yii::app()->twitter->getTwitterTokened($_SESSION['oauth_token'], $_SESSION['oauth_token_secret']);	
			
			/* Request access tokens from twitter */
			$access_token = $twitter->getAccessToken($_REQUEST['oauth_verifier']);
		
			/* Save the access tokens. Normally these would be saved in a database for future use. */
			$_SESSION['access_token'] = $access_token;

			/* Remove no longer needed request tokens */
			unset($_SESSION['oauth_token']);
			unset($_SESSION['oauth_token_secret']);

			if (200 == $twitter->http_code) {
				/* The user has been verified and the access tokens can be saved for future use */
				$_SESSION['status'] = 'verified';
				header('Location: ./index.php');
			} else {
		  		/* Save HTTP status for error dialog on connnect page.*/
				header('Location: ./clearsessions.php');
			}

			
			
Posting to Twitter


			$twitter = Yii::app()->twitter->getTwitterTokened($_SESSION[access_token]['oauth_token'], 
				$_SESSION[access_token]['oauth_token_secret']);
			$twitter->post('statuses/update', array('status' => "The Time Is ".date(DATE_RFC822)));
